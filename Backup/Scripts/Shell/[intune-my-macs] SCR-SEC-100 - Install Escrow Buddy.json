{
     "executionFrequency": "PT0S",
     "retryCount": 0,
     "blockExecutionNotifications": false,
     "displayName": "[intune-my-macs] SCR-SEC-100 - Install Escrow Buddy",
     "description": "Downloads and installs the latest release of Escrow Buddy security agent plugin from GitHub. Ensures FileVault recovery keys are properly escrowed to Intune by configuring the authorization database and triggering escrow at login when the FDE profile and PRK file are present.",
     "scriptContent": "IyEvYmluL2Jhc2gKI3NldCAteAoKIyBTY3JpcHQgTmFtZTogaW5zdGFsbEVCLnNoCiMgRGVzY3JpcHRpb246IFRoaXMgc2NyaXB0IGRvd25sb2FkcyBhbmQgaW5zdGFsbHMgdGhlIGxhdGVzdCByZWxlYXNlIG9mIEVzY3JvdyBCdWRkeSwgYSBzZWN1cml0eSBhZ2VudCBwbHVnaW4gZm9yIG1hY09TLiAKIyAgICAgICAgICAgICAgVGhlIHNjcmlwdCBjaGVja3MgaWYgdGhlIGxvZyBkaXJlY3RvcnkgaGFzIGJlZW4gY3JlYXRlZCBhbmQgY3JlYXRlcyBpdCBpZiBuZWNlc3NhcnkuIAojICAgICAgICAgICAgICBJdCBhbHNvIGRlZmluZXMgc2V2ZXJhbCBmdW5jdGlvbnMgZm9yIGRvd25sb2FkaW5nIGFuZCB1cGRhdGluZyBFc2Nyb3cgQnVkZHksIGFzIHdlbGwgYXMgY2hlY2tpbmcgaWYgdGhlIEVzY3JvdyBCdWRkeSBhdXRob3JpemF0aW9uZGIgZW50cnkgaXMgY29uZmlndXJlZC4gCiMgICAgICAgICAgICAgIFRoZSBsb2dnZXIgZnVuY3Rpb24gaXMgdXNlZCB0byBsb2cgbWVzc2FnZXMgdG8gc3Rkb3V0IGFuZCBhIGxvZyBmaWxlLgojIFZlcnNpb246IDEuMC4yCiMgQXV0aG9yOiBUb2JpYXMgQWxtw6luCiMgRGF0ZTogMjAyNC0wNi0xNAoKIyBNYW51YWwgdmVyc2lvbiBvdmVycmlkZQp2ZXJzaW9uPSIiICMgT25seSBjb25maWd1cmUgdGhpcyBpZiB5b3Ugd2FudCB0byBjb250cm9sIHRoZSB2ZXJzaW9uIG9mIEVzY3JvdyBCdWRkeSB0aGF0IGlzIGluc3RhbGxlZCwgb3RoZXJ3aXNlIGxlYXZlIGl0IGJsYW5rLiBFeGFtcGxlOiB2ZXJzaW9uPSIxLjAuMCIKCiMgU2V0IHRoZSBwYXRoIHRvIHRoZSBpbnN0YWxsZWQgRXNjcm93IEJ1ZGR5IGJ1bmRsZQppbnN0YWxsX3BhdGg9Ii9MaWJyYXJ5L1NlY3VyaXR5L1NlY3VyaXR5QWdlbnRQbHVnaW5zL0VzY3JvdyBCdWRkeS5idW5kbGUiCiMgU2V0IHRoZSBwYXRoIHRvIHRoZSBsb2cgZGlyZWN0b3J5CmxvZ2FuZG1ldGFkaXI9Ii9MaWJyYXJ5L0xvZ3MvTWljcm9zb2Z0L0ludHVuZVNjcmlwdHMvRXNjcm93QnVkZHkiCiMgRmlsZSB0byBzdG9yZSBsYXN0IHVwZGF0ZWR0aW1lCmxhc3R1cGRhdGVkPSIkbG9nYW5kbWV0YWRpci9sYXN0dXBkYXRlZCIKIyBTZXQgdGhlIEFQSSBVUkwgZm9yIHRoZSBsYXRlc3QgcmVsZWFzZSBvZiBFc2Nyb3cgQnVkZHkKZWJfdXJsPSJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL21hY2FkbWlucy9lc2Nyb3ctYnVkZHkvcmVsZWFzZXMvbGF0ZXN0IgojIFNldCB0aGUgcGF0aCB0byB0aGUgaW5zdGFsbGVkIEVzY3JvdyBCdWRkeSBidW5kbGUKaW5zdGFsbF9wYXRoPSIvTGlicmFyeS9TZWN1cml0eS9TZWN1cml0eUFnZW50UGx1Z2lucy9Fc2Nyb3cgQnVkZHkuYnVuZGxlIgojIEN1cmwgdGhlIEFQSSBVUkwgZm9yIHRoZSBsYXRlc3QgcmVsZWFzZSBhbmQgZG93bmxvYWQgdXJsIG9mIEVzY3JvdyBCdWRkeQpyZXNwb25zZT0kKGN1cmwgLS1zaWxlbnQgIiRlYl91cmwiKQojIEdldCB0aGUgbGF0ZXN0IHJlbGVhc2Ugb2YgRXNjcm93IEJ1ZGR5CmxhdGVzdF9yZWxlYXNlPSQoZWNobyAiJHJlc3BvbnNlIiB8IGdyZXAgLW8gJyJ0YWdfbmFtZSI6ICJbXiJdKicgfCBncmVwIC1vICdbXiJdKiQnKQojIEdldCB0aGUgbnVtZXJpY2FsIHZlcnNpb24gb2YgdGhlIGxhdGVzdCByZWxlYXNlIG9mIEVzY3JvdyBCdWRkeQpsYXRlc3RfdmVyc2lvbj0kKGVjaG8gIiRsYXRlc3RfcmVsZWFzZSIgfCBjdXQgLWMgMi0pCiMgR2V0IEZERSBzdGF0dXMKRkRFX1NUQVRVUz0kKGZkZXNldHVwIHN0YXR1cykKIyBHZXQgRkRFIHByb2ZpbGUgc3RhdHVzCkZERV9QUk9GSUxFPSIvTGlicmFyeS9NYW5hZ2VkIFByZWZlcmVuY2VzL2NvbS5hcHBsZS5zZWN1cml0eS5GREVSZWNvdmVyeUtleUVzY3Jvdy5wbGlzdCIKIyBQYXRoIHRvIEZpbGVWYXVsdFBSSwpQUks9Ii92YXIvZGIvRmlsZVZhdWx0UFJLLmRhdCIKCiMjIENoZWNrIGlmIHRoZSBsb2cgZGlyZWN0b3J5IGhhcyBiZWVuIGNyZWF0ZWQKaWYgWyAtZCAkbG9nYW5kbWV0YWRpciBdOyB0aGVuCgkjIyBBbHJlYWR5IGNyZWF0ZWQKCWVjaG8gIlskKGRhdGUgKyIlWS0lbS0lZCAlSDolTTolUyIpXSBbSU5GT10gTG9nIGRpcmVjdG9yeSBhbHJlYWR5IGV4aXN0cyAtICRsb2dhbmRtZXRhZGlyIgplbHNlCgkjIyBDcmVhdGluZyBNZXRhZGlyZWN0b3J5CgllY2hvICJbJChkYXRlICsiJVktJW0tJWQgJUg6JU06JVMiKV0gW0lORk9dIGNyZWF0aW5nIGxvZyBkaXJlY3RvcnkgLSAkbG9nYW5kbWV0YWRpciIKCW1rZGlyIC1wICRsb2dhbmRtZXRhZGlyCmZpCgojIEZ1bmN0aW9uIHRvIGxvZyBtZXNzYWdlcyB0byBzdGRvdXQKZnVuY3Rpb24gbG9nZ2VyKCkgewogICAgIyBGdW5jdGlvbiB0byBsb2cgbWVzc2FnZXMgdG8gc3Rkb3V0IGFuZCBhIGxvZyBmaWxlCiAgICAjCiAgICAjIEFyZ3VtZW50czoKICAgICMgICAkMTogVGhlIGxvZyBsZXZlbCAoZS5nLiBJTkZPLCBXQVJOSU5HLCBFUlJPUikKICAgICMgICAkMjogVGhlIG1lc3NhZ2UgdG8gbG9nCgogICAgbGV2ZWw9JDEKICAgIG1lc3NhZ2U9JDIKCiAgICAjIExvZyB0aGUgbWVzc2FnZSB3aXRoIHRoZSBjdXJyZW50IGRhdGUgYW5kIHRpbWUgYW5kIHRoZSBzcGVjaWZpZWQgbG9nIGxldmVsCiAgICBkYXRlPSQoZGF0ZSArIiVZLSVtLSVkICVIOiVNOiVTIikKICAgIGVjaG8gIlskZGF0ZV0gWyRsZXZlbF0gJG1lc3NhZ2UiCiAgICBlY2hvICJbJGRhdGVdIFskbGV2ZWxdICRtZXNzYWdlIiA+PiAiJGxvZ2FuZG1ldGFkaXIvaW5zdGFsbGViLmxvZyIKfQoKZnVuY3Rpb24gcmVtZWRpYXRlKCkgewogICAgIyBGdW5jdGlvbiB0byByZW1lZGlhdGUgbWlzc2luZyBGViBrZXkKICAgICMKICAgICMgQXJndW1lbnRzOgogICAgIyAgIE5vbmUKICAgICMgUmV0dXJuczoKICAgICMgICBOb25lCiAgICAjIFZhcmlhYmxlczoKICAgICMgICAkRkRFX1NUQVRVUzogVGhlIHN0YXR1cyBvZiBGaWxlVmF1bHQKICAgICMgICAkRkRFX1BST0ZJTEU6IEZERSBwcm9maWxlIHBhdGgKICAgICMgICAkUFJLOiBUaGUgcGF0aCB0byB0aGUgRmlsZVZhdWx0UFJLCgogICAgIyBJZiBGaWxlVmF1bHQgaXMgbm90IGVuYWJsZWQsIGV4aXQKICAgIGlmIFsgIkZpbGVWYXVsdCBpcyBPbi4iICE9ICIkRkRFX1NUQVRVUyIgXTsgdGhlbgogICAgICAgIGV4aXQgMAogICAgZmkKCiAgICAjIElmIHRoZSBlc2Nyb3cgcGxpc3QgZXhpc3RzLCBjaGVjayBmb3IgdGhlIHJlY292ZXJ5IGtleSBmaWxlCiAgICBpZiBbIC1mICIkRkRFX1BST0ZJTEUiIF07IHRoZW4KICAgICAgICAjIElmIHRoZSBrZXkgaGFzIGJlZW4gZXNjcm93ZWQsIGV4aXQKICAgICAgICBpZiBbIC1mICIkUFJLIiBdOyB0aGVuCiAgICAgICAgICAgIGxvZ2dlciAiSU5GTyIgIktleSBoYXMgYmVlbiBlc2Nyb3dlZCIKICAgICAgICAjIElmIHRoZSBrZXkgaGFzIG5vdCBiZWVuIGVzY3Jvd2VkLCBzZXQgR2VuZXJhdGVOZXdLZXkgdG8gdHJ1ZQogICAgICAgIGVsc2UKICAgICAgICAgICAgbG9nZ2VyICJJTkZPIiAiS2V5IGhhcyBub3QgYmVlbiBlc2Nyb3dlZCIKICAgICAgICAgICAgZGVmYXVsdHMgd3JpdGUgL0xpYnJhcnkvUHJlZmVyZW5jZXMvY29tLm5ldGZsaXguRXNjcm93LUJ1ZGR5LnBsaXN0IEdlbmVyYXRlTmV3S2V5IC1ib29sIHRydWUKICAgICAgICBmaQogICAgIyBJZiB0aGUgZXNjcm93IHBsaXN0IGRvZXMgbm90IGV4aXN0LCBkbyBub3RoaW5nCiAgICBlbHNlCiAgICAgICAgbG9nZ2VyICJJTkZPIiAiTm8gRmlsZVZhdWx0IHByb2ZpbGUgaGFzIGJlZW4gYXBwbGllZCIKICAgIGZpCn0KCmZ1bmN0aW9uIGdldFZlcnNpb24oKSB7CiAgICAjIENvbnZlcnQgYSB2ZXJzaW9uIHN0cmluZyBpbiB0aGUgZm9ybWF0IHgueS56LncgdG8gYW4gaW50ZWdlcgogICAgIyBOYWJiZWQgZnJvbSBNYXR0J3MgV1MxIGV4YW1wbGUgYW5kIHNsaWdodGx5IG1vZGlmaWVkCiAgICAjCiAgICAjIEFyZ3VtZW50czoKICAgICMgICAkMTogVGhlIHZlcnNpb24gc3RyaW5nIHRvIGNvbnZlcnQKICAgICMgUmV0dXJuczoKICAgICMgICBUaGUgaW50ZWdlciByZXByZXNlbnRhdGlvbiBvZiB0aGUgdmVyc2lvbiBzdHJpbmcKICAgICMgVmFyaWFibGVzOgogICAgIyAgIE5vbmUKCiAgICBlY2hvICIkMSIgfCBhd2sgLUYuICd7IHByaW50ZigiJWQlZCVkJWRcbiIsICQxLCQyLCQzLCQ0KTsgfScKfQoKIyBGdW5jdGlvbiB0byBkb3dubG9hZCB0aGUgbGF0ZXN0IHJlbGVhc2Ugb2YgRXNjcm93IEJ1ZGR5CmZ1bmN0aW9uIGRvd25sb2FkRXNjcm93QnVkZHkoKSB7CiAgICAjIERvd25sb2FkIHRoZSBsYXRlc3QgcmVsZWFzZSBvZiBFc2Nyb3cgQnVkZHkKICAgICMKICAgICMgQXJndW1lbnRzOgogICAgIyAgIE5vbmUKICAgICMgUmV0dXJuczoKICAgICMgICBOb25lCiAgICAjIFZhcmlhYmxlczoKICAgICMgICAkcmVzcG9uc2U6IFRoZSByZXNwb25zZSBmcm9tIHRoZSBBUEkgVVJMIGZvciB0aGUgbGF0ZXN0IHJlbGVhc2Ugb2YgRXNjcm93IEJ1ZGR5CiAgICAjICAgJGRvd25sb2FkX3VybDogVGhlIGRvd25sb2FkIFVSTCBmb3IgdGhlIGxhdGVzdCByZWxlYXNlIG9mIEVzY3JvdyBCdWRkeQoKICAgICMgR2V0IHRoZSBkb3dubG9hZCBVUkwgZm9yIHRoZSBsYXRlc3QgcmVsZWFzZQogICAgZG93bmxvYWRfdXJsPSQoZWNobyAiJHJlc3BvbnNlIiB8IGdyZXAgLW8gJyJicm93c2VyX2Rvd25sb2FkX3VybCI6ICJbXiJdKicgfCBncmVwIC1vICdbXiJdKiQnIHwgZ3JlcCAtaSAnXC5wa2ckJykKCiAgICAjIERvd25sb2FkIHRoZSBsYXRlc3QgcmVsZWFzZSBvZiBFc2Nyb3cgQnVkZHkKICAgIGxvZ2dlciAiSU5GTyIgIkRvd25sb2FkaW5nIEVzY3JvdyBCdWRkeSAkbGF0ZXN0X3JlbGVhc2UiCiAgICBjdXJsIC1MIC1zICIkZG93bmxvYWRfdXJsIiAtbyAiL3RtcC9Fc2Nyb3cuQnVkZHkucGtnIgoKICAgICMgQ2hlY2sgaWYgdGhlIGRvd25sb2FkIHdhcyBzdWNjZXNzZnVsCiAgICBpZiBbICQ/IC1lcSAwIF07IHRoZW4KICAgICAgICBsb2dnZXIgIklORk8iICJFc2Nyb3cgQnVkZHkgJGxhdGVzdF9yZWxlYXNlIGRvd25sb2FkZWQgc3VjY2Vzc2Z1bGx5IgogICAgZWxzZQogICAgICAgIGxvZ2dlciAiRVJST1IiICJFc2Nyb3cgQnVkZHkgJGxhdGVzdF9yZWxlYXNlIGRvd25sb2FkIGZhaWxlZCIKICAgICAgICBleGl0IDEKICAgIGZpCn0KCiMgRnVuY3Rpb24gdG8gdXBkYXRlIEVzY3JvdyBCdWRkeSBpZiBhIG5ldyB2ZXJzaW9uIGlzIGF2YWlsYWJsZQpmdW5jdGlvbiB1cGRhdGVFc2Nyb3dCdWRkeSgpIHsKICAgICMgVXBkYXRlIEVzY3JvdyBCdWRkeSBpZiBhIG5ldyB2ZXJzaW9uIGlzIGF2YWlsYWJsZQogICAgIwogICAgIyBBcmd1bWVudHM6CiAgICAjICAgaW5wdXRfdmVyc2lvbjogVGhlIGhpZ2hlc3QgdmVyc2lvbiBvZiBFc2Nyb3cgQnVkZHkgdG8gaW5zdGFsbAogICAgIyBSZXR1cm5zOgogICAgIyAgIE5vbmUKICAgICMgVmFyaWFibGVzOgogICAgIyAgICRyZXNwb25zZTogVGhlIHJlc3BvbnNlIGZyb20gdGhlIEFQSSBVUkwgZm9yIHRoZSBsYXRlc3QgcmVsZWFzZSBvZiBFc2Nyb3cgQnVkZHkKICAgICMgICAkZG93bmxvYWRfdXJsOiBUaGUgZG93bmxvYWQgVVJMIGZvciB0aGUgbGF0ZXN0IHJlbGVhc2Ugb2YgRXNjcm93IEJ1ZGR5CiAgICAjICAgJGxhc3Rtb2RpZmllZDogVGhlIGxhc3QgbW9kaWZpZWQgZGF0ZSBvZiB0aGUgbGF0ZXN0IHJlbGVhc2Ugb2YgRXNjcm93IEJ1ZGR5CiAgICAjICAgJHByZXZpb3VzbGFzdG1vZGlmaWVkZGF0ZTogVGhlIGxhc3QgbW9kaWZpZWQgZGF0ZSBvZiB0aGUgcHJldmlvdXNseSBpbnN0YWxsZWQgcmVsZWFzZSBvZiBFc2Nyb3cgQnVkZHkKICAgICMgICAkbGFzdHVwZGF0ZWQ6IFRoZSBwYXRoIHRvIHRoZSBmaWxlIGNvbnRhaW5pbmcgdGhlIGxhc3QgbW9kaWZpZWQgZGF0ZSBvZiB0aGUgcHJldmlvdXNseSBpbnN0YWxsZWQgcmVsZWFzZSBvZiBFc2Nyb3cgQnVkZHkKCiAgICAjIE1hbnVhbCB2ZXJzaW9uIG92ZXJyaWRlCiAgICBpbnB1dF92ZXJzaW9uPSQxCgogICAgIyBJZiB0aGUgaW5wdXQgdmVyc2lvbiBpcyBzZXQsIGNoZWNrIGlmIGFuIHVwZGF0ZSBpcyBhdmFpbGFibGUKICAgIGlmIFsgIiRpbnB1dF92ZXJzaW9uIiBdOyB0aGVuIAogICAgICAgICMgQ2hlY2sgaWYgRXNjcm93IEJ1ZGR5IGlzIGluc3RhbGxlZAogICAgICAgIGlmIFsgLWQgIiRpbnN0YWxsX3BhdGgiIF07IHRoZW4KICAgICAgICAgICAgIyBJZiB0aGUgaW5wdXQgdmVyc2lvbiBpcyBub3QgdGhlIHNhbWUgYXMgdGhlIGxhdGVzdCB2ZXJzaW9uLCBsb2cgYSB3YXJuaW5nCiAgICAgICAgICAgIGlmIFsgJChnZXRWZXJzaW9uICRpbnB1dF92ZXJzaW9uKSAhPSAkKGdldFZlcnNpb24gJGxhdGVzdF92ZXJzaW9uKSBdOyB0aGVuCiAgICAgICAgICAgICAgICBsb2dnZXIgIldBUk5JTkciICJJbnB1dCB2ZXJzaW9uIFskaW5wdXRfdmVyc2lvbl0gZG9lcyBub3QgbWF0Y2ggbGF0ZXN0IHZlcnNpb24gWyRsYXRlc3RfdmVyc2lvbl0iCiAgICAgICAgICAgICMgSWYgdGhlIGlucHV0IHZlcnNpb24gYW5kIHRoZSBsYXRlc3QgdmVyc2lvbiBhcmUgdGhlIHNhbWUsIGNoZWNrIGlmIGFuIHVwZGF0ZSBpcyBhdmFpbGFibGUKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgIyBHZXQgdGhlIHZlcnNpb24gb2YgdGhlIGN1cnJlbnRseSBpbnN0YWxsZWQgcmVsZWFzZSBvZiBFc2Nyb3cgQnVkZHkKICAgICAgICAgICAgICAgIGluc3RhbGxlZF92ZXJzaW9uPSQoZGVmYXVsdHMgcmVhZCAiJGluc3RhbGxfcGF0aCIvQ29udGVudHMvSW5mby5wbGlzdCBDRkJ1bmRsZVNob3J0VmVyc2lvblN0cmluZykKICAgICAgICAgICAgICAgIGlmIFsgJChnZXRWZXJzaW9uICRpbnB1dF92ZXJzaW9uKSAtZ3QgJChnZXRWZXJzaW9uICRpbnN0YWxsZWRfdmVyc2lvbikgXTsgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvZ2dlciAiSU5GTyIgIlVwZGF0ZSBmb3VuZCwgaW5wdXQgdmVyc2lvbiBbJGlucHV0X3ZlcnNpb25dIGFuZCBjdXJyZW50IFskaW5zdGFsbGVkX3ZlcnNpb25dIgogICAgICAgICAgICAgICAgICAgICMgSW5zdGFsbCB0aGUgbGF0ZXN0IHJlbGVhc2Ugb2YgRXNjcm93IEJ1ZGR5CiAgICAgICAgICAgICAgICAgICAgaW5zdGFsbEVzY3Jvd0J1ZGR5CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyICJJTkZPIiAiTm8gdXBkYXRlIGZvdW5kLCBpbnB1dCB2ZXJzaW9uIFskaW5wdXRfdmVyc2lvbl0gYW5kIGN1cnJlbnQgWyRpbnN0YWxsZWRfdmVyc2lvbl0iCiAgICAgICAgICAgICAgICBmaQogICAgICAgICAgICBmaQogICAgICAgIGVsc2UKICAgICAgICAgICAgbG9nZ2VyICJJTkZPIiAiVW5hYmxlIHRvIGNoZWNrIGZvciB1cGRhdGVzLCBFc2Nyb3cgQnVkZHkgaXMgbm90IGluc3RhbGxlZCwgaW5zdGFsbGluZyIKICAgICAgICAgICAgIyBJbnN0YWxsIHRoZSBsYXRlc3QgcmVsZWFzZSBvZiBFc2Nyb3cgQnVkZHkKICAgICAgICAgICAgaW5zdGFsbEVzY3Jvd0J1ZGR5CiAgICAgICAgZmkKCiAgICBlbHNlCiAgICAgICAgIyBHZXQgdGhlIGRvd25sb2FkIFVSTCBmb3IgdGhlIGxhdGVzdCByZWxlYXNlCiAgICAgICAgZG93bmxvYWRfdXJsPSQoZWNobyAiJHJlc3BvbnNlIiB8IGdyZXAgLW8gJyJicm93c2VyX2Rvd25sb2FkX3VybCI6ICJbXiJdKicgfCBncmVwIC1vICdbXiJdKiQnIHwgZ3JlcCAtaSAnXC5wa2ckJykKICAgICAgICAjIEdldCB0aGUgbGFzdCBtb2RpZmllZCBkYXRlIGZvciB0aGUgbGF0ZXN0IHJlbGVhc2UKICAgICAgICBsYXN0bW9kaWZpZWQ9JChjdXJsIC1zSUwgIiRkb3dubG9hZF91cmwiIHwgZ3JlcCAtaSAibGFzdC1tb2RpZmllZCIgfCBhd2sgJ3skMT0iIjsgcHJpbnQgJDB9JyB8IGF3ayAneyBzdWIoL15bIFx0XSsvLCAiIik7IHByaW50IH0nIHwgdHIgLWQgJ1xyJykKCiAgICAgICAgIyBDaGVjayBpZiB0aGUgbGFzdCBtb2RpZmllZCBkYXRlIG9mIHRoZSBsYXRlc3QgcmVsZWFzZSBpcyBkaWZmZXJlbnQgdG8gdGhlIGxhc3QgbW9kaWZpZWQgZGF0ZSBvZiB0aGUgcHJldmlvdXNseSBpbnN0YWxsZWQgcmVsZWFzZQogICAgICAgIGlmIFsgLWYgIiRsYXN0dXBkYXRlZCIgXTsgdGhlbgogICAgICAgICAgICBwcmV2aW91c2xhc3Rtb2RpZmllZGRhdGU9JChjYXQgIiRsYXN0dXBkYXRlZCIpCiAgICAgICAgICAgIGlmIFtbICIkcHJldmlvdXNsYXN0bW9kaWZpZWRkYXRlIiAhPSAiJGxhc3Rtb2RpZmllZCIgXV07IHRoZW4KICAgICAgICAgICAgICAgIGxvZ2dlciAiSU5GTyIgIlVwZGF0ZSBmb3VuZCwgcHJldmlvdXMgWyRwcmV2aW91c2xhc3Rtb2RpZmllZGRhdGVdIGFuZCBjdXJyZW50IFskbGFzdG1vZGlmaWVkXSIKCiAgICAgICAgICAgICAgICAjIEluc3RhbGwgdGhlIGxhdGVzdCByZWxlYXNlIG9mIEVzY3JvdyBCdWRkeQogICAgICAgICAgICAgICAgaW5zdGFsbEVzY3Jvd0J1ZGR5CiAgICAgICAgICAgICMgSWYgdGhlIGxhc3QgbW9kaWZpZWQgZGF0ZSBvZiB0aGUgbGF0ZXN0IHJlbGVhc2UgaXMgdGhlIHNhbWUgYXMgdGhlIGxhc3QgbW9kaWZpZWQgZGF0ZSBvZiB0aGUgcHJldmlvdXNseSBpbnN0YWxsZWQgcmVsZWFzZSwgZG8gbm90aGluZwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBsb2dnZXIgIklORk8iICJObyB1cGRhdGUgYmV0d2VlbiBwcmV2aW91cyBbJHByZXZpb3VzbGFzdG1vZGlmaWVkZGF0ZV0gYW5kIGN1cnJlbnQgWyRsYXN0bW9kaWZpZWRdIgogICAgICAgICAgICBmaQoKICAgICAgICAjIElmIHRoZSBsYXN0IG1vZGlmaWVkIGRhdGUgb2YgdGhlIHByZXZpb3VzbHkgaW5zdGFsbGVkIHJlbGVhc2UgaXMgbm90IGZvdW5kLCBpbnN0YWxsIHRoZSBsYXRlc3QgcmVsZWFzZSBvZiBFc2Nyb3cgQnVkZHkKICAgICAgICBlbHNlCiAgICAgICAgICAgIGxvZ2dlciAiSU5GTyIgIk1ldGEgZmlsZSBbJGxhc3R1cGRhdGVkXSBub3QgZm91bmQiCiAgICAgICAgICAgIGxvZ2dlciAiSU5GTyIgIlVuYWJsZSB0byBkZXRlcm1pbmUgaWYgdXBkYXRlIHJlcXVpcmVkIHNvIHVwZGF0aW5nIGFueXdheSIKCiAgICAgICAgICAgICMgSW5zdGFsbCB0aGUgbGF0ZXN0IHJlbGVhc2Ugb2YgRXNjcm93IEJ1ZGR5CiAgICAgICAgICAgIGluc3RhbGxFc2Nyb3dCdWRkeQoKICAgICAgICBmaQoKICAgIGZpCgp9CgojIEZ1bmN0aW9uIHRvIGluc3RhbGwgRXNjcm93IEJ1ZGR5CmZ1bmN0aW9uIGluc3RhbGxFc2Nyb3dCdWRkeSgpIHsKICAgICMgSW5zdGFsbCB0aGUgbGF0ZXN0IHJlbGVhc2Ugb2YgRXNjcm93IEJ1ZGR5CiAgICAjCiAgICAjIEFyZ3VtZW50czoKICAgICMgICBOb25lCiAgICAjIFJldHVybnM6CiAgICAjICAgTm9uZQogICAgIyBWYXJpYWJsZXM6CiAgICAjICAgTm9uZQoKICAgICMgSW5zdGFsbCBFc2Nyb3cgQnVkZHkKICAgIGRvd25sb2FkRXNjcm93QnVkZHkKICAgIGxvZ2dlciAiSU5GTyIgIkluc3RhbGxpbmcgRXNjcm93IEJ1ZGR5IgogICAgc3VkbyBpbnN0YWxsZXIgLXBrZyAiL3RtcC9Fc2Nyb3cuQnVkZHkucGtnIiAtdGFyZ2V0ICIvIiA+IC9kZXYvbnVsbCAyPiYxCiAgICBleGl0Y29kZT0kPwoKICAgICMgQ2xlYW4gdXAKICAgIHJtIC1mICIvdG1wL0VzY3Jvdy5CdWRkeS5wa2ciCgogICAgIyBDaGVjayBpZiB0aGUgaW5zdGFsbGF0aW9uIHdhcyBzdWNjZXNzZnVsCiAgICBpZiBbICRleGl0Y29kZSAtZXEgMCBdOyB0aGVuCiAgICAgICAgbG9nZ2VyICJJTkZPIiAiRXNjcm93IEJ1ZGR5IGluc3RhbGxlZCBzdWNjZXNzZnVsbHkiCiAgICAgICAgbGFzdG1vZGlmaWVkPSQoY3VybCAtc0lMICIkZG93bmxvYWRfdXJsIiB8IGdyZXAgLWkgImxhc3QtbW9kaWZpZWQiIHwgYXdrICd7JDE9IiI7IHByaW50ICQwfScgfCBhd2sgJ3sgc3ViKC9eWyBcdF0rLywgIiIpOyBwcmludCB9JyB8IHRyIC1kICdccicpCiAgICAgICAgbG9nZ2VyICJJTkZPIiAiV3JpdGluZyBsYXN0IHVwZGF0ZSBpbmZvcm1hdGlvbiB0byBbJGxhc3R1cGRhdGVkXSIKICAgICAgICBlY2hvICRsYXN0bW9kaWZpZWQgPiIkbGFzdHVwZGF0ZWQiCiAgICBlbHNlCiAgICAgICAgbG9nZ2VyICJFUlJPUiIgIkVzY3JvdyBCdWRkeSBpbnN0YWxsYXRpb24gZmFpbGVkIgogICAgICAgIGV4aXQgMQogICAgZmkKfQoKIyBDaGVjayBpZiBFc2Nyb3cgQnVkZHkgaXMgYWxyZWFkeSBpbnN0YWxsZWQKaWYgWyAtZCAiJGluc3RhbGxfcGF0aCIgXTsgdGhlbgogICAgIyBJZiBFc2Nyb3cgQnVkZHkgaXMgYWxyZWFkeSBpbnN0YWxsZWQsIGNoZWNrIGlmIGFuIHVwZGF0ZSBpcyByZXF1aXJlZAogICAgbG9nZ2VyICJJTkZPIiAiRXNjcm93IEJ1ZGR5IGFscmVhZHkgaW5zdGFsbGVkLCBjaGVja2luZyBmb3IgdXBkYXRlIiAKICAgIHVwZGF0ZUVzY3Jvd0J1ZGR5ICR2ZXJzaW9uCmVsc2UKICAgICMgSWYgRXNjcm93IEJ1ZGR5IGlzIG5vdCBpbnN0YWxsZWQsIGluc3RhbGwgaXQKICAgIGxvZ2dlciAiSU5GTyIgIkVzY3JvdyBCdWRkeSBub3QgaW5zdGFsbGVkLCBpbnN0YWxsaW5nIiAKICAgIGluc3RhbGxFc2Nyb3dCdWRkeQpmaQoKIyBDaGVjayBpZiBFc2Nyb3cgQnVkZHkgYXV0aG9yaXphdGlvbmRiIGVudHJ5IGlzIGNvbmZpZ3VyZWQKIiRpbnN0YWxsX3BhdGgiL0NvbnRlbnRzL1Jlc291cmNlcy9BdXRoREJTZXR1cC5zaCB8IHdoaWxlIHJlYWQgbGluZTsgZG8KICAgIGxvZ2dlciAiSU5GTyIgIiRsaW5lIgpkb25lCgojIFJ1biByZW1lZGlhdGlvbgpyZW1lZGlhdGU=",
     "runAsAccount": "system",
     "fileName": "scr-sec-100-install-escrow-buddy.sh",
     "roleScopeTagIds": [
          "Default"
     ]
}